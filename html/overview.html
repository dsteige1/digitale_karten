<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Überblick</title>

    <link rel="icon" type="image/png" href="https://img.icons8.com/material-outlined/96/000000/map.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="../javascript/connector.js"></script>
    <link rel="stylesheet" href="../css/style.css">

    <script>

        //Funktionen um die einzelnen Werte auszugeben

        function getNameOfHosts() {
            var result = [];
            loop1: for (var i = 0; i < data.datenbank.event.length; i++) {
                var name = data.datenbank.event[i].veranstaltung.gastgeber;
                for (var i2 = 0; i2 < result.length; i2++) {
                    if (result[i2] === name) {
                        continue loop1;
                    }
                }
                result.push(name);
            }
            return result;
        }

        function getNameOfClubs() {
            var result = [];
            loop1: for (var i = 0; i < data.datenbank.event.length; i++) {
                var name = data.datenbank.event[i].location.gaststaette;
                for (var i2 = 0; i2 < result.length; i2++) {
                    if (result[i2] === name) {
                        continue loop1;
                    }
                }
                result.push(name);
            }
            return result;
        }

        function getAverageEntryFee() {
            var arr = [];
            for (let i = 0; i < data.datenbank.event.length; i++) {
                var eintritt = parseInt(data.datenbank.event[i].veranstaltung.eintritt);

                if (eintritt !== 0 && !isNaN(eintritt)) {
                    arr.push(eintritt);
                }
            }
            var sum, avg;
            if (arr.length) {
                sum = arr.reduce(function (a, b) { return a + b; });
                avg = sum / arr.length;
            }
            return avg;
        }

        function getMaxVisitedEvent() {
            var arr = [];
            for (let i = 0; i < data.datenbank.event.length; i++) {
                var visitors = parseInt(data.datenbank.event[i].veranstaltung.teilnehmerzahl.teilgenommen) + parseInt(data.datenbank.event[i].veranstaltung.teilnehmerzahl.interessiert);
                var id = parseInt(data.datenbank.event[i].id);
                arr.push({ "index": i, "id": id, "visitors": visitors })
            }

            arr = arr.sort(function (a, b) {
                return (a["visitors"] > b["visitors"]) ? 1 : ((a["visitors"] < b["visitors"]) ? -1 : 0);
            });

            var eventIndex = arr[arr.length - 1]["index"];
            //var eventName  = data.datenbank.event[eventIndex].veranstaltung.name;

            return eventIndex;
        }

        document.addEventListener("DOMContentLoaded", function () {
            var overview = document.getElementById("overview");
            overview.innerHTML = "Die Datenbank hat insgesamt " + (data.datenbank.event.length - 1) + " Einträge von " + getNameOfClubs().length + " Clubs." +
                "<br>Der durchschnittliche Eintrittspreis beträgt " + getAverageEntryFee() + "€." +
                "<p>Das meistbesuchte Event ist " + data.datenbank.event[getMaxVisitedEvent()].veranstaltung.name + " im " + data.datenbank.event[getMaxVisitedEvent()].location.gaststaette + "</p>";

        });

    </script>
</head>

<body>
    <div>
        <nav class="navbar navbar bg navbar-fixed-top">
            <span class="navbar-brand mb-0 h1">Besucheraufkommen der Gaststätten in Ehrenfeld - 2018</span>
        </nav>
    </div>
    <nav id="nav">
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link" href="#">Projekt</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="#">Data</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="index.html">Darstellung 1 | Slider</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="timer.html">Darstellung 2 | Animation</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="viewOn.html">Darstellung 3</a>
            </li>
        </ul>
    </nav>
    <div id="overview"></div>
</body>

</html>